% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_km_and_parametric.R
\name{plot_km_and_parametric}
\alias{plot_km_and_parametric}
\title{Plot Kaplan-Meier Curves with Parametric Distribution Overlay}
\usage{
plot_km_and_parametric(
  dataset,
  distribution,
  conf_int = TRUE,
  risk_table_interval = NULL
)
}
\arguments{
\item{dataset}{A data frame containing survival analysis data with columns:
ARM (treatment arm), SURVTIME (survival time), EVENT (event indicator)}

\item{distribution}{Character string specifying the parametric distribution.
Must be one of: "exp", "weibull", "lnorm", "llogis", "gompertz", "gengamma", "gamma"}

\item{conf_int}{Logical indicating whether to display 95\% confidence intervals on
Kaplan-Meier curves. Default is TRUE}

\item{risk_table_interval}{Numeric value specifying the time interval for risk table output.
If NULL (default), automatically sets interval to 10\% of plot_time_horizon.
If numeric value provided, uses that as the interval. Default is NULL}
}
\value{
A list containing:
\describe{
\item{plot}{ggplot object with Kaplan-Meier curves and parametric overlays}
\item{risktable}{Data frame showing number at risk at regular intervals}
}
}
\description{
This function creates a combined visualization of Kaplan-Meier survival curves
with overlaid parametric distribution fits. It supports multiple treatment arms
and displays confidence intervals optionally.
}
\details{
The function performs the following operations:
\itemize{
\item Fits Kaplan-Meier curves using \code{survival::survfit()}
\item Fits parametric survival models independently for each ARM
\item Calculates number at risk at regular intervals
\item Axes begin at (0, 0) for improved visualization
\item X-axis extends to the longest ARM's last event time
\item Handles single and multiple ARM datasets
}
}
\examples{
\dontrun{
# Example 1: Single arm analysis
dataset1 <- generate_dummy_survival_data(
  arm = c("Treatment"),
  n = c(100),
  hazards = log(2) / 20,
  dropout_per_year = 0.1,
  seed = 123
)

dataset1_processed <- processing_dataset(
  dataset = dataset1,
  column_arm = "ARM",
  column_survtime = "SURVTIME",
  column_cnsr = "CNSR",
  column_event = NULL
)

result <- plot_km_and_parametric(
  dataset = dataset1_processed,
  distribution = "weibull",
  conf_int = TRUE
)

print(result$plot)
print(result$risktable)

# Example 2: Two-arm trial with custom risk table interval
dataset <- generate_dummy_survival_data(
  arm = c("Treatment", "Control"),
  n = c(100, 100),
  hazards = log(2) / c(20, 15),
  dropout_per_year = 0.1,
  seed = 123
)

dataset_processed <- processing_dataset(
  dataset = dataset,
  column_arm = "ARM",
  column_survtime = "SURVTIME",
  column_cnsr = "CNSR",
  column_event = NULL
)

result <- plot_km_and_parametric(
  dataset = dataset_processed,
  distribution = "weibull",
  conf_int = TRUE,
  risk_table_interval = 6
)

print(result$plot)
print(result$risktable)

# Example 3: Three-arm trial
dataset3 <- generate_dummy_survival_data(
  arm = c("Treatment A", "Treatment B", "Control"),
  n = c(80, 90, 100),
  hazards = log(2) / c(25, 20, 15),
  dropout_per_year = 0.1,
  seed = 456
)

dataset3_processed <- processing_dataset(
  dataset = dataset3,
  column_arm = "ARM",
  column_survtime = "SURVTIME",
  column_cnsr = "CNSR",
  column_event = NULL
)

result3 <- plot_km_and_parametric(
  dataset = dataset3_processed,
  distribution = "weibull",
  conf_int = TRUE,
  risk_table_interval = 6
)

print(result3$plot)
print(result3$risktable)
}
}
