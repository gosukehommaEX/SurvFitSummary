% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_hazard_and_parametric.R
\name{plot_hazard_and_parametric}
\alias{plot_hazard_and_parametric}
\title{Plot Smoothed Empirical Hazard with Parametric Distribution Overlay}
\usage{
plot_hazard_and_parametric(
  dataset,
  distribution,
  conf_int = TRUE,
  time_scale = "week",
  time_horizon = NULL
)
}
\arguments{
\item{dataset}{A data frame containing survival analysis data with columns:
ARM (treatment arm), SURVTIME (survival time), EVENT (event indicator)}

\item{distribution}{Character string specifying the parametric distribution.
Must be one of: "exp", "weibull", "lnorm", "llogis", "gompertz", "gengamma", "gamma"}

\item{conf_int}{Logical indicating whether to display 95\% confidence intervals on
hazard curves. Default is TRUE}

\item{time_scale}{Character string specifying the unit of time scale in the input dataset.
Must be one of: "day", "week", "month", "year". Default is "week"}

\item{time_horizon}{Numeric value specifying the maximum time point in the specified
time_scale unit. If NULL (default), uses the maximum observed survival time in the
dataset}
}
\value{
A list containing:
\describe{
\item{plot}{A ggplot object containing multiple panels arranged by ARM.
Each ARM has side-by-side plots for time and log(time) axes with
smoothed empirical hazard (solid line) overlaid with parametric hazard (dashed line)}
\item{hazard_data}{A named list of data frames, one for each treatment arm.
Each data frame contains columns: time, hazard, lower_ci, upper_ci, type, ARM}
}
}
\description{
This function creates visualizations of smoothed empirical hazard functions
overlaid with parametric distribution hazard curves. For each treatment arm,
it generates two plots side-by-side: hazard versus time (natural scale) and
hazard versus log(time). Separate panels are created for each treatment arm
to assess the visual fit of the parametric model to the observed data.
}
\details{
The function performs the following operations:
\itemize{
\item Converts input SURVTIME from time_scale to weeks internally
\item Calculates smoothed empirical hazard using \code{bshazard::bshazard()}
\item Fits parametric survival models independently for each ARM
\item Creates side-by-side plots (time vs log(time)) for each ARM
\item All time values are displayed in the input time_scale unit
}

Interpretation guidelines:
\itemize{
\item Close alignment between empirical and parametric curves suggests good model fit
\item Large deviations indicate the chosen distribution may not adequately
represent the data for that ARM
\item log(time) axis plots help identify distributional shape violations
}
}
\examples{
\dontrun{
# Example: Two-arm trial
dataset <- generate_dummy_survival_data(
  arm = c("Treatment", "Control"),
  n = c(100, 100),
  hazards = log(2) / c(20, 15),
  dropout_per_year = 0.1,
  seed = 123
)

dataset_processed <- processing_dataset(
  dataset = dataset,
  column_arm = "ARM",
  column_survtime = "SURVTIME",
  column_cnsr = "CNSR",
  column_event = NULL
)

# Plot for Weibull distribution
p <- plot_hazard_and_parametric(
  dataset = dataset_processed,
  distribution = "weibull",
  conf_int = TRUE,
  time_scale = "week",
  time_horizon = 100
)

print(p$plot)
# Access hazard data for each ARM
head(p$hazard_data$Treatment)
}
}
