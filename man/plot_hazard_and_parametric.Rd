% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_hazard_and_parametric.R
\name{plot_hazard_and_parametric}
\alias{plot_hazard_and_parametric}
\title{Plot Smoothed Empirical Hazard with Parametric Distribution Overlay (Facet Grid Version)}
\usage{
plot_hazard_and_parametric(dataset, distribution, conf_int = TRUE)
}
\arguments{
\item{dataset}{A data frame containing survival analysis data with columns:
ARM (treatment arm), SURVTIME (survival time), EVENT (event indicator)}

\item{distribution}{Character string specifying the parametric distribution.
Must be one of: "exp", "weibull", "lnorm", "llogis", "gompertz", "gengamma", "gamma"}

\item{conf_int}{Logical indicating whether to display 95\% confidence intervals on
hazard curves. Default is TRUE}
}
\value{
A list containing:
\describe{
\item{plot}{A ggplot object with facet_grid layout. Rows = ARMs, Columns = Time scales}
\item{hazard_data}{A named list of data frames, one for each treatment arm.
Each data frame contains columns: time, hazard, lower_ci, upper_ci, type, ARM}
}
}
\description{
This function creates visualizations of smoothed empirical hazard functions
overlaid with parametric distribution hazard curves using facet_grid.
Rows represent treatment arms, columns represent time scales (Time vs log(Time)).
}
\details{
The function performs the following operations:
\itemize{
\item Calculates smoothed empirical hazard using \code{bshazard::bshazard()}
\item Fits parametric survival models independently for each ARM
\item Parametric hazard is calculated over the same time range as empirical hazard
\item Creates facet_grid with ARM as rows and time scale as columns
\item Each ARM has independent x-axis range based on its data
}
}
\examples{
\dontrun{
# Example 1: Single-arm trial
dataset1 <- generate_dummy_survival_data(
  arm = c("Treatment"),
  n = c(150),
  hazards = log(2) / 20,
  dropout_per_year = 0.1,
  seed = 123
)

dataset1_processed <- processing_dataset(
  dataset = dataset1,
  column_arm = "ARM",
  column_survtime = "SURVTIME",
  column_cnsr = "CNSR",
  column_event = NULL
)

p1 <- plot_hazard_and_parametric(
  dataset = dataset1_processed,
  distribution = "weibull",
  conf_int = TRUE
)
print(p1$plot)

# Example 2: Two-arm trial
dataset2 <- generate_dummy_survival_data(
  arm = c("Treatment", "Control"),
  n = c(100, 100),
  hazards = log(2) / c(20, 15),
  dropout_per_year = 0.1,
  seed = 456
)

dataset2_processed <- processing_dataset(
  dataset = dataset2,
  column_arm = "ARM",
  column_survtime = "SURVTIME",
  column_cnsr = "CNSR",
  column_event = NULL
)

p2 <- plot_hazard_and_parametric(
  dataset = dataset2_processed,
  distribution = "exp",
  conf_int = TRUE
)
print(p2$plot)

# Example 3: Three-arm trial
dataset3 <- generate_dummy_survival_data(
  arm = c("Treatment A", "Treatment B", "Control"),
  n = c(80, 80, 80),
  hazards = log(2) / c(22, 18, 15),
  dropout_per_year = 0.1,
  seed = 789
)

dataset3_processed <- processing_dataset(
  dataset = dataset3,
  column_arm = "ARM",
  column_survtime = "SURVTIME",
  column_cnsr = "CNSR",
  column_event = NULL
)

p3 <- plot_hazard_and_parametric(
  dataset = dataset3_processed,
  distribution = "gompertz",
  conf_int = TRUE
)
print(p3$plot)
}
}
